# FileFinder-MultiThread-USN
high speed local searcher/本地高速文件查找器
《windows文件搜索器极速版》
要求：
1、要求比windows搜索效率高得多（使用多线程）。
2、选择系统路径和输入文件名片段后，能够查找到路径下所有包含文件名片段的文件和文件夹。
3、实时快速显示进程数，查找到的文件和文件夹个数。实时显示当前搜索路径（用独立的界面线程）。
4、双击查找结果，能打开路径。并能在路径中双击打开文件。
5、右键查找结果，能够弹出菜单，三个功能：打开文件、打开路径、复制路径到剪切板。
6、所有控件、界面线程都能顺滑地实时显示状态。不能有阻塞、闪烁、之后。不能有内存泄漏。
7、所有窗口和控件。无论是属于主窗口，还是属于用户界面线程窗口。在主窗口进行拖动、缩放、最大化等操作时，都要同样移动。有必要的要进行缩放。
8、在多线程的基础上再提速，模仿《everything》，使用windows系统的USN日志，加速查找过程。

提效设计思路：1、开启多线程。 2、利用USN日志。

知识点：
1、工作线程和非模态对话框界面线程的建立、销毁。
2、非模态对话框如何设置为主对话框的子对话框（由于不在一个线程内，移动缩放等要自己处理了），以及如何管理。
3、线程同步技术，这里用到的是原子互锁，用来计数子线程数量和查找结果。
4、线程间通讯。这里用到了全局变量、类管理、自建结构体(类)指针传递、AfxGetApp等多种方法。但对话框，一般推荐发消息的模式。
5、递归、MFC消息管理等。
6、windows系统浏览器、剪切板、文件浏览器的操作。
7、NTFS文件系统USN日志的使用。

难点：使用非模态对话框创建的界面线程，关闭界面和关闭线程额逻辑。注意：界面线程的关闭并不能使其窗口和各类资源关闭，这些都要手动释放。界面线程关闭，只需把线程关联的界面关闭。

误区：SetWindowPos设置控件坐标时。以前一直认为设定的是屏幕坐标。其实，它是啥坐标取决于x，y是啥坐标系。

参考：
1、https://blog.csdn.net/luoyouren/article/details/45010533	利用CWinThread实现跨线程父子MFC窗口
2、MSDN  搜索CWnd::OpenClipboard  Windows	剪切板操作在VC系IDE下的实现
3、https://wenku.baidu.com/view/fe483763ab956bec0975f46527d3240c8447a182.html	MFC基于对话框，弹出菜单资源并管理响应。
4、https://www.likecs.com/show-429118.html	MFC 关闭非模态对话框
5、https://blog.csdn.net/XuePiaoFei1/article/details/49026545	Everything研究之读取NTFS下的USN日志文件












